Пока погрешности огромные, но возможно в цикле будет лучше
По крайней мере, не ругается на то, что определитель равен 0
Весь РМНК в мейне 
